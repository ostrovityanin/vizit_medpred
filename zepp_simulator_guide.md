# Руководство по тестированию с использованием Zepp OS Simulator

## Установка и настройка симулятора

### 1. Установка Node.js
Убедитесь, что установлена последняя версия Node.js (14+)
```bash
node -v  # Должно показать v14.x.x или выше
```

### 2. Установка симулятора Zepp OS
```bash
npm install -g @zeppos/cli
```

### 3. Запуск симулятора
```bash
zapp simulator
```

## Тестирование приложения в симуляторе

### Установка приложения в симулятор
1. В меню симулятора выберите: Developer > Install App
2. Выберите файл `zepp_app_bundle.zab`
3. Приложение должно появиться в списке установленных приложений

### Проверка работы приложения
1. Запустите приложение в симуляторе
2. Проверьте навигацию по экранам приложения
3. Проверьте функцию записи аудио
   - *Примечание:* В симуляторе будет эмулироваться работа микрофона
   - Для этого может использоваться аудиофайл из ресурсов симулятора

### Проверка отправки данных на сервер
1. Убедитесь, что симулятор настроен на перенаправление сетевых запросов
   - В меню Developer > Network Settings
   - Убедитесь, что включена опция "Redirect network requests"
2. Создайте тестовую запись и проверьте логи сервера

## Отладка приложения

### Просмотр логов симулятора
1. В меню симулятора выберите: Developer > View Logs
2. Обратите внимание на ошибки и предупреждения

### Использование отладчика
1. В меню симулятора выберите: Developer > Enable Debug Mode
2. Откройте Chrome DevTools (обычно по адресу http://localhost:3000)
3. Используйте инструменты разработчика для отладки

## Тестирование интеграции с сервером

### Тестирование API
Для быстрой проверки API интеграции используйте тестовый скрипт:
```bash
node test-zepp-integration.js
```

Этот скрипт эмулирует отправку аудио фрагментов и финализацию записи без необходимости запуска симулятора.

### Тестирование с эмуляцией неустойчивого соединения
Для проверки надежности можно эмулировать проблемы с сетью:
1. В меню симулятор: Developer > Network Conditions
2. Выберите "Flaky connection" для эмуляции нестабильного соединения
3. Проверьте, как приложение обрабатывает потерю соединения и повторные попытки

## Типичные проблемы и их решения

### Ошибка загрузки приложения
- Проверьте структуру пакета, особенно наличие необходимых файлов
- Убедитесь, что файл `zepp.config.json` содержит правильные настройки
- Проверьте, что папка `page` (не `pages`) содержит все необходимые файлы

### Проблемы с API-запросами
- Проверьте, что URL в приложении указан корректно
- Убедитесь, что сервер доступен и принимает запросы
- Проверьте формат данных, отправляемых на сервер

### Ошибки компиляции
- Проверьте, что код соответствует стандарту Zepp OS 3.0
- Убедитесь, что используются правильные импорты и API
- Удалите любые несовместимые библиотеки или API