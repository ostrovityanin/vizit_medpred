# Интеграция с Zepp OS

## Обзор
Проект интегрирован с платформой Zepp OS для записи аудио на умных часах. 
Интеграция позволяет записывать аудио на часах Amazfit GTR 3 Pro и отправлять его на сервер.

## Компоненты интеграции

### 1. Пакет приложения для Zepp OS
- **Местоположение**: [`zepp_proper_package/`](./zepp_proper_package/)
- **Готовый бандл**: [`zepp_app_bundle.zab`](./zepp_app_bundle.zab)

### 2. Серверные API для работы с Zepp OS
- **Маршруты для получения фрагментов**: `/api/zepp/recording-fragments`
- **Маршрут для финализации записи**: `/api/zepp/finalize-recording`

### 3. Тестовый скрипт
- **Файл**: [`test-zepp-integration.js`](./test-zepp-integration.js)
- **Назначение**: Тестирование интеграции без необходимости использования физического устройства

## Особенности реализации

### Работа с фрагментами аудио
Из-за ограничений Zepp OS, длинные аудиозаписи разбиваются на фрагменты и отправляются последовательно:

1. **Запись фрагментов**: Каждый фрагмент записывается и сохраняется локально
2. **Отправка фрагментов**: Фрагменты отправляются на сервер с уникальным `sessionId`
3. **Финализация**: После отправки всех фрагментов, отправляется запрос для объединения на сервере

### Обработка ошибок и повторные попытки
Реализована система повторных попыток для:
- Отправки фрагментов при сбоях сети
- Сохранения записи локально при недоступности сервера
- Автоматического восстановления после перезапуска приложения

## Установка на устройство

Существует два способа установки приложения:

1. **Через Zepp Developer Portal**
   - Публикация приложения в официальном магазине

2. **Прямая установка для тестирования**
   - Установка .zab файла напрямую на устройство в режиме разработчика

Подробные инструкции доступны в файле [zepp_deploy_instructions.md](./zepp_deploy_instructions.md).

## Тестирование интеграции

Для тестирования интеграции без устройства запустите:

```bash
node test-zepp-integration.js
```

Этот скрипт эмулирует процесс записи и отправки аудио с часов Zepp OS.

## Задачи в будущих версиях

1. Добавить поддержку дополнительных устройств
2. Расширить локализацию на другие языки
3. Добавить отображение статуса транскрибации на устройстве
4. Оптимизировать формат сжатия аудио для экономии трафика